import{r as j,b as L,j as e,d as M,p as m,f as k,h as U,R as y}from"./index-Bh_Q_c63.js";import{F}from"./FavoriteButton-DQve410x.js";const E=({shark:s})=>{const[n,a]=j.useState(null),r=s&&s.image!=="Unknown"?L(s.image):[],l=i=>a(i),t=()=>a(null);return j.useEffect(()=>{if(n===null)return;const i=c=>{c.key==="ArrowLeft"?a(u=>Math.max(u-1,0)):c.key==="ArrowRight"?a(u=>Math.min(u+1,r.length-1)):c.key==="Escape"&&t()};return window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)},[n,r.length]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"shark-images-container",children:[e.jsx("h3",{children:"Media Gallery"}),r.length>0?r.map((i,c)=>e.jsxs("div",{className:"shark-image-card",children:[e.jsx("img",{src:i.url,alt:`Shark image ${c}`,onClick:()=>l(c),style:{cursor:"pointer"}}),e.jsx("p",{className:"shark-image-meta",children:e.jsxs("small",{children:["ðŸ“¸ Creator: ",i.creator," | ",i.license]})})]},c)):e.jsx("p",{children:"No media available."})]}),n!==null&&e.jsx("div",{className:"image-overlay",onClick:t,children:e.jsxs("div",{className:"overlay-content",onClick:i=>i.stopPropagation(),children:[e.jsx("button",{className:"carousel-button left",onClick:()=>a(i=>Math.max(i-1,0)),disabled:n===0,children:"< "}),e.jsxs("div",{className:"overlay-image-wrapper",children:[e.jsx("img",{src:r[n].url,alt:`Expanded shark image ${n}`}),e.jsxs("p",{className:"overlay-meta",children:["ðŸ“¸ Creator: ",r[n].creator," | ",r[n].license]})]}),e.jsx("button",{className:"carousel-button right",onClick:()=>a(i=>Math.min(i+1,r.length-1)),disabled:n===r.length-1,children:"> "}),e.jsx("button",{className:"close-button",onClick:t,children:"X"})]})})]})},Y=({shark:s})=>{if(!s)return e.jsxs("div",{className:"shark-info-panel",children:[e.jsx("h2",{children:"All Sharks Overview"}),e.jsx("p",{children:"Select a shark to view detailed tracking information."})]});const n=s.countries.split(",").map(t=>t.trim()),a=s.regions?s.regions.split(",").map(t=>t.trim()):[],r=s.publishing?s.publishing.split(",").map(t=>t.trim()):[],l=s.remarks||"";return e.jsxs("div",{className:"shark-info-panel",children:[e.jsxs("h2",{children:["ID: ",s.id,e.jsx(F,{sharkId:s.id})]}),e.jsxs("div",{className:"shark-panel-details",children:[e.jsxs("div",{className:"shark-traits",children:[e.jsxs("p",{className:"shark-details",children:[e.jsx("strong",{children:"Sex:"}),"Â  ",s.sex]}),e.jsxs("p",{className:"shark-details",children:[e.jsx("strong",{children:"Life Stage:"}),"Â  ",s.lifeStage]})]}),e.jsxs("div",{className:"shark-records",children:[e.jsxs("h3",{className:"shark-details",children:[e.jsx("strong",{children:"Total Records:"}),"Â  ",s.occurrences]}),e.jsxs("p",{className:"shark-details",children:[s.oldest," Â ...Â  ",s.newest]}),e.jsxs("p",{className:"shark-details",children:[e.jsx("strong",{children:"Satellite tracking:"}),"Â Â ",Math.round(s.machine/(s.machine+s.human)*100),"%"]}),e.jsxs("p",{className:"shark-details",children:[e.jsx("strong",{children:"Human sightings:"}),"Â Â ",Math.round(s.human/(s.machine+s.human)*100),"%"]})]}),e.jsxs("div",{className:"shark-regions",children:[e.jsx("h3",{className:"shark-details",children:"Places Visited"}),e.jsx("ul",{className:"timeline-list",children:n.map((t,i)=>{const c=a[i]||"Unknown",u=r[i]||"Unspecified",h=l||"None",x=M(c),p=M(t),d=x!=="Unknown"?x:p;return e.jsxs("li",{className:"timeline-item",children:[e.jsxs("div",{className:"timeline-header",children:[e.jsx("strong",{children:m(t)})," ",e.jsxs("span",{className:"timeline-date",children:["(",d,")"]})]}),e.jsxs("div",{className:"timeline-region",children:[e.jsx("span",{className:"timeline-label",children:"Region:"})," ",e.jsx("em",{children:c!=="Unknown"?m(c):"Unspecified"})]}),e.jsxs("div",{className:"timeline-meta",children:[e.jsx("span",{className:"timeline-label",children:"Published by:"})," ",e.jsx("em",{children:u!=="Unknown"?u:"Unspecified"})]}),e.jsxs("div",{className:"timeline-remarks",children:[e.jsx("span",{className:"timeline-label",children:"Sighting remarks:"})," ",e.jsx("em",{children:h!=="Unknown"?k(h):"None"})]})]},i)})})]}),e.jsx(E,{shark:s})]})]})};function O({criteria:s,onChange:n}){return e.jsxs("fieldset",{className:"filter-group",children:[e.jsx("legend",{children:"Media"}),e.jsxs("label",{className:"filter-label",children:[e.jsx("input",{type:"checkbox",checked:s.showOnlyWithMedia,onChange:()=>n({...s,showOnlyWithMedia:!s.showOnlyWithMedia})}),"Sharks with real-world images"]})]})}function A({criteria:s,onChange:n,countries:a,publishingCountries:r}){return e.jsxs("fieldset",{className:"filter-group",children:[e.jsx("legend",{children:"Location"}),e.jsxs("label",{className:"filter-label",children:["Country:",e.jsxs("select",{value:s.country,onChange:l=>n({...s,country:l.target.value}),className:"filter-select",children:[e.jsx("option",{value:"",children:"All"}),a.map(l=>e.jsx("option",{value:l,children:l},l))]})]}),e.jsxs("label",{className:"filter-label",children:["Publishing Country:",e.jsxs("select",{value:s.publishingCountry,onChange:l=>n({...s,publishingCountry:l.target.value}),className:"filter-select",children:[e.jsx("option",{value:"",children:"All"}),r.map(l=>e.jsx("option",{value:l,children:l},l))]})]})]})}function T({criteria:s,onChange:n,minYear:a,maxYear:r}){return e.jsxs("fieldset",{className:"filter-group",children:[e.jsx("legend",{children:"Time"}),e.jsxs("label",{className:"filter-label",children:["Year Range:",e.jsxs("div",{className:"range-inputs",children:[e.jsx("input",{type:"number",value:s.yearRange[0],onChange:l=>{const t=l.target.value;n({...s,yearRange:[t,s.yearRange[1]]})},onBlur:()=>{const l=parseInt(s.yearRange[0]),t=isNaN(l)?a:Math.max(a,Math.min(l,parseInt(s.yearRange[1])));n({...s,yearRange:[String(t),s.yearRange[1]]})},className:"filter-input"}),e.jsx("span",{style:{margin:"0 0.25rem"},children:"to"}),e.jsx("input",{type:"number",value:s.yearRange[1],onChange:l=>{const t=l.target.value;n({...s,yearRange:[s.yearRange[0],t]})},onBlur:()=>{const l=parseInt(s.yearRange[1]),t=isNaN(l)?r:Math.min(r,Math.max(l,parseInt(s.yearRange[0])));n({...s,yearRange:[s.yearRange[0],String(t)]})},className:"filter-input"})]})]})]})}function B({criteria:s,onChange:n,minRecords:a,maxRecords:r}){return e.jsxs("fieldset",{className:"filter-group",children:[e.jsx("legend",{children:"Metadata"}),e.jsxs("label",{className:"filter-label",children:[e.jsx("input",{type:"checkbox",checked:s.hasOccurrenceNotes,onChange:()=>n({...s,hasOccurrenceNotes:!s.hasOccurrenceNotes})}),"Sharks with occurrence notes"]}),e.jsxs("label",{className:"filter-label",children:["Min Records:",e.jsx("input",{type:"number",min:a,max:r,value:s.minRecords,onChange:l=>{const t=l.target.value;n({...s,minRecords:t})},onBlur:()=>{const l=parseInt(s.minRecords,10);if(isNaN(l)){n({...s,minRecords:a});return}const t=Math.max(a,Math.min(l,r));n({...s,minRecords:t})},className:"filter-input"})]})]})}function D({criteria:s,onChange:n}){return e.jsxs("fieldset",{className:"filter-group",children:[e.jsx("legend",{children:"Biological"}),e.jsxs("label",{className:"filter-label",children:["Sex:",e.jsxs("select",{value:s.sex,onChange:a=>n({...s,sex:a.target.value}),className:"filter-select",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"}),e.jsx("option",{value:"Unknown",children:"Unknown"})]})]}),e.jsxs("label",{className:"filter-label",children:["Life Stage:",e.jsxs("select",{value:s.lifeStage,onChange:a=>n({...s,lifeStage:a.target.value}),className:"filter-select",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"Juvenile",children:"Juvenile"}),e.jsx("option",{value:"Subadult",children:"Subadult"}),e.jsx("option",{value:"Adult",children:"Adult"}),e.jsx("option",{value:"Unknown",children:"Unknown"})]})]}),e.jsxs("label",{className:"filter-label",children:["Observation Type:",e.jsxs("select",{value:s.observationType,onChange:a=>n({...s,observationType:a.target.value}),className:"filter-select",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"Satellite",children:"Satellite Tracking"}),e.jsx("option",{value:"Human",children:"Human Sightings"})]})]})]})}function $({criteria:s,onChange:n,options:a}){const{countries:r=[],publishingCountries:l=[],minYear:t=2e3,maxYear:i=2024,minRecords:c=1,maxRecords:u=100}=a;return e.jsxs("div",{className:"shark-filters scrollable-filters",children:[e.jsx(O,{criteria:s,onChange:n}),e.jsx(A,{criteria:s,onChange:n,countries:r,publishingCountries:l}),e.jsx(T,{criteria:s,onChange:n,minYear:t,maxYear:i}),e.jsx(B,{criteria:s,onChange:n,minRecords:c,maxRecords:u}),e.jsx(D,{criteria:s,onChange:n})]})}function R(s,n){return Array.from(new Set(s.flatMap(a=>{var r;return((r=a[n])==null?void 0:r.split(",").map(l=>m(l).trim()).filter(Boolean))||[]}))).sort((a,r)=>a.localeCompare(r))}function H(s,n){return s.filter(a=>{var r;if(n.showOnlyWithMedia&&!(a.image&&a.image.trim()!==""&&a.image!=="Unknown")||n.country&&!(a.countries||"").split(",").map(i=>m(i).toLowerCase().trim()).some(i=>i.includes(n.country.toLowerCase()))||n.publishingCountry&&!(a.publishing||"").split(",").map(i=>m(i).toLowerCase().trim()).some(i=>i.includes(n.publishingCountry.toLowerCase())))return!1;if(n.yearRange){const l=parseInt(a.oldest),t=parseInt(a.newest),i=parseInt(n.yearRange[0]),c=parseInt(n.yearRange[1]);if(isNaN(l)||isNaN(t)||t<i||l>c)return!1}if(n.hasOccurrenceNotes&&k(a.remarks)==="None"||n.minRecords>0&&a.occurrences<n.minRecords||n.sex&&(((r=a.sex)==null?void 0:r.toLowerCase())||"")!==n.sex.toLowerCase()||n.lifeStage&&U(a).toLowerCase()!==n.lifeStage.toLowerCase())return!1;if(n.observationType){let l=!0;if(n.observationType=="Satellite"?l=a.machine>0:n.observationType=="Human"&&(l=a.human>0),!l)return!1}return!0})}function G({sharks:s,onReset:n,onSelect:a,selectedSharkId:r,DisplayComponent:l,disabled:t=!1,onFilteredSharksChange:i}){const c=R(s,"countries"),u=R(s,"publishing"),h=Math.min(...s.map(o=>o.occurrences||1)),x=Math.max(...s.map(o=>o.occurrences||1)),p=s.flatMap(o=>[parseInt(o.oldest),parseInt(o.newest)]).filter(o=>!isNaN(o)),d=Math.min(...p),f=Math.max(...p),b=y.useMemo(()=>({showOnlyWithMedia:!1,country:"",yearRange:[String(d),String(f)],hasOccurrenceNotes:!1,minRecords:1,sex:"",lifeStage:"",publishingCountry:"",observationType:""}),[d,f]),[g,w]=j.useState(b),[N,S]=j.useState(!0),C=()=>{w(b),S(!1),n&&n()},v=y.useMemo(()=>{console.log("Computing filteredSharks with criteria:",g);const o=H(s,g);return console.log(`filterSharks result: ${o.length}/${s.length} sharks`),o},[s,g]);y.useEffect(()=>{i&&i(v)},[v,i]);const I={countries:c,publishingCountries:u,minYear:d,maxYear:f,minRecords:h,maxRecords:x};return e.jsx("div",{style:{display:"flex",flexDirection:"column",height:"100%",opacity:t?.6:1,pointerEvents:t?"none":"auto"},children:e.jsxs("div",{className:"shark-selector-list",children:[e.jsx("button",{onClick:C,className:`show-all-button ${r==null?"active":""}`,disabled:t,children:"Show All Sharks"}),e.jsxs("div",{className:"filter-toggle-container",children:[e.jsx("button",{onClick:()=>S(o=>!o),className:`toggle-filter-button ${N?"active":""}`,disabled:t,children:N?"Hide Filters â–²":"Show Filters â–¼"}),N&&e.jsx($,{criteria:g,onChange:w,options:I,disabled:t})]}),e.jsx(l,{sharks:v,onSelect:a,selectedSharkId:r,disabled:t})]})})}export{Y as S,G as a};
