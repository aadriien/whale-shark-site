import{j as e,r as j}from"./index-Xc6aK7Cq.js";import{g as k,p as f,a as v,b as y,e as C,c as w,d as D,f as S,h as b,G as A,m as R}from"./DataUtils-BdeqNBzU.js";import"./three.module-CsHAom45.js";import"./linear-DWw4ICw8.js";import"./country-list-CMU6V2HV.js";const E=({shark:s})=>s?e.jsxs("div",{className:"shark-info-panel",children:[e.jsxs("h2",{children:["ID: ",s.id]}),e.jsxs("div",{className:"shark-panel-details",children:[e.jsxs("div",{className:"shark-traits",children:[e.jsxs("p",{className:"shark-details",children:[e.jsx("strong",{children:"Sex:"}),"  ",s.sex]}),e.jsxs("p",{className:"shark-details",children:[e.jsx("strong",{children:"Life Stage:"}),"  ",s.lifeStage]})]}),e.jsxs("div",{className:"shark-records",children:[e.jsxs("h3",{className:"shark-details",children:[e.jsx("strong",{children:"Total Records:"}),"  ",s.occurrences]}),e.jsxs("p",{className:"shark-details",children:[s.oldest,"  ...  ",s.newest]}),e.jsxs("p",{className:"shark-details",children:[e.jsx("strong",{children:"Satellite tracking:"}),"  ",Math.round(s.machine/(s.machine+s.human)*100),"%"]}),e.jsxs("p",{className:"shark-details",children:[e.jsx("strong",{children:"Human sightings:"}),"  ",Math.round(s.human/(s.machine+s.human)*100),"%"]})]}),e.jsxs("div",{className:"shark-regions",children:[e.jsx("h3",{className:"shark-details",children:"Places Visited"}),e.jsx("ul",{className:"timeline-list",children:s.countries.split(",").map((i,d)=>{const c=s.regions||"",r=s.publishing||"",h=s.remarks||"",t=k(c),g=k(i),a=t!=="Unknown"?t:g;return e.jsxs("li",{className:"timeline-item",children:[e.jsxs("div",{className:"timeline-header",children:[e.jsx("strong",{children:f(i)})," ",e.jsxs("span",{className:"timeline-date",children:["(",a,")"]})]}),e.jsxs("div",{className:"timeline-region",children:[e.jsx("span",{className:"timeline-label",children:"Region:"})," ",e.jsx("em",{children:c!=="Unknown"?f(c):"Unspecified"})]}),e.jsxs("div",{className:"timeline-meta",children:[e.jsx("span",{className:"timeline-label",children:"Published by:"})," ",e.jsx("em",{children:f(r)})]}),e.jsxs("div",{className:"timeline-remarks",children:[e.jsx("span",{className:"timeline-label",children:"Sighting remarks:"})," ",e.jsx("em",{children:h!=="Unknown"?v(h):"None"})]})]},d)})})]}),e.jsxs("div",{className:"shark-images-container",children:[e.jsx("h3",{children:"Media Gallery"}),y(s.image).map((i,d)=>e.jsxs("div",{className:"shark-image-card",children:[e.jsx("img",{src:i.url,alt:`Shark image ${d}`}),e.jsx("p",{className:"shark-image-meta",children:e.jsxs("small",{children:["📸 Creator: ",i.creator," | ",i.license]})})]},d))]})]})]}):e.jsxs("div",{className:"shark-info-panel",children:[e.jsx("h2",{children:"All Sharks Overview"}),e.jsx("p",{children:"Select a shark to view detailed tracking information."})]}),I=new Set(["Africa","Antarctica","Asia","Europe","North America","Oceania","South America"]);function G({sharks:s,onReset:i,onSelect:d,selectedSharkId:c}){const[r,h]=j.useState({}),t={};s.forEach(a=>{C(a.continent).forEach(l=>{I.has(l)&&(t[l]||(t[l]=[]),t[l].push(a))})});const g=a=>{h(n=>({...n,[a]:!n[a]}))};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[e.jsx("button",{onClick:i,className:c==null?"active":"",children:e.jsx("span",{className:"all-sharks-button-text",children:"Show All Sharks"})}),e.jsx("div",{className:"shark-selector-list",children:Object.entries(t).sort(([a],[n])=>a.localeCompare(n)).map(([a,n])=>{const l=r[a];return e.jsxs("div",{className:"continent-dropdown",children:[e.jsxs("div",{className:"continent-header",onClick:()=>g(a),children:[a," ",l?"▾":"▸"]}),l&&e.jsx("div",{className:"continent-shark-list",children:n.map(o=>e.jsx("div",{className:`shark-selector-item ${o.id===c?"selected":""}`,onClick:()=>d(o.id),children:(()=>{const m=f(o.countries.trim()),x=w(m);return e.jsxs(e.Fragment,{children:[x?e.jsxs("div",{className:"flag-and-code",children:[e.jsx("img",{src:`https://flagcdn.com/24x18/${x}.png`,alt:m,title:m,className:"flag-icon",loading:"lazy"}),e.jsx("span",{className:"country-code",children:x.toUpperCase()})]}):e.jsxs("span",{className:"flag-and-code",title:m,role:"img","aria-label":"unknown country",children:["🌍 ",e.jsx("span",{className:"country-code",children:"N/A"})]}),o.id]})})()},o.id))})]},a)})})]})}function P(){const[s,i]=j.useState(null),[d,c]=j.useState(!0),r=j.useRef(),h=D(),t=R;j.useEffect(()=>{var n;if(s)(n=r.current)==null||n.highlightShark(s.id),c(!1);else{if(r.current){const l=r.current.getGlobe();S(l),b(l,h)}c(!0)}},[s]),j.useEffect(()=>{if(r.current){const n=r.current.getGlobe();S(n),b(n,h)}},[]);const g=n=>{if(typeof n=="object"&&n.lat!==void 0&&n.lng!==void 0){if(!d){console.log("Ignoring click because not all sharks are visible.");return}const{lat:l,lng:o}=n;console.log("Clicked at lat/lng:",l,o);const m=3,x=h.find(u=>{const p=Math.abs(u.lat-l),N=Math.abs(u.lng-o);return p<m&&N<m});if(x){const u=x.id.split("-")[0];console.log("Matched shark:",x.id," with ID: ",u);const p=t.find(N=>N.id==u)||null;console.log("Sending shark obect:",p),i(p)}else console.log("No nearby shark found."),i(null)}else{const l=t.find(o=>o.id==n)||null;i(l)}},a=()=>{i(null),c(!0)};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",overflowY:"auto",textAlign:"center",paddingTop:"60px"},children:[e.jsx("h1",{children:"GlobeViews Page"}),e.jsxs("div",{className:"globe-views-container",children:[e.jsx("div",{className:"info-sidebar",children:e.jsx(E,{shark:s,onReset:a})}),e.jsx("div",{className:"globe-container",children:e.jsx(A,{ref:r,onSharkClick:g})}),e.jsx("div",{className:"shark-selector",children:e.jsx(G,{sharks:t,onSelect:g,onReset:a,selectedSharkId:s?s.id:null})})]})]})}export{P as default};
