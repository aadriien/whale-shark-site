import{r as f,a as C,j as e,i as I,t as L,d as S,p as N,f as k,h as F,R as M}from"./index-C72PlvvJ.js";const $=({shark:s})=>{const[l,a]=f.useState({}),[t,n]=f.useState(null),i=s&&s.image!=="Unknown"?C(s.image):[],c=r=>n(r),m=()=>n(null);if(f.useEffect(()=>{if(t===null)return;const r=o=>{o.key==="ArrowLeft"?n(u=>Math.max(u-1,0)):o.key==="ArrowRight"?n(u=>Math.min(u+1,i.length-1)):o.key==="Escape"&&m()};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[t,i.length]),!s)return e.jsxs("div",{className:"shark-info-panel",children:[e.jsx("h2",{children:"All Sharks Overview"}),e.jsx("p",{children:"Select a shark to view detailed tracking information."})]});const x=s.countries.split(",").map(r=>r.trim()),v=s.regions?s.regions.split(",").map(r=>r.trim()):[],p=s.publishing?s.publishing.split(",").map(r=>r.trim()):[],g=s.remarks||"";return e.jsxs("div",{className:"shark-info-panel",children:[e.jsxs("h2",{children:["ID: ",s.id,e.jsx("button",{className:"favorite-button",onClick:r=>{r.stopPropagation(),L(s.id),a({})},children:I(s.id)?"â˜…":"â˜†"})]}),e.jsxs("div",{className:"shark-panel-details",children:[e.jsxs("div",{className:"shark-traits",children:[e.jsxs("p",{className:"shark-details",children:[e.jsx("strong",{children:"Sex:"}),"Â  ",s.sex]}),e.jsxs("p",{className:"shark-details",children:[e.jsx("strong",{children:"Life Stage:"}),"Â  ",s.lifeStage]})]}),e.jsxs("div",{className:"shark-records",children:[e.jsxs("h3",{className:"shark-details",children:[e.jsx("strong",{children:"Total Records:"}),"Â  ",s.occurrences]}),e.jsxs("p",{className:"shark-details",children:[s.oldest," Â ...Â  ",s.newest]}),e.jsxs("p",{className:"shark-details",children:[e.jsx("strong",{children:"Satellite tracking:"}),"Â Â ",Math.round(s.machine/(s.machine+s.human)*100),"%"]}),e.jsxs("p",{className:"shark-details",children:[e.jsx("strong",{children:"Human sightings:"}),"Â Â ",Math.round(s.human/(s.machine+s.human)*100),"%"]})]}),e.jsxs("div",{className:"shark-regions",children:[e.jsx("h3",{className:"shark-details",children:"Places Visited"}),e.jsx("ul",{className:"timeline-list",children:x.map((r,o)=>{const u=v[o]||"Unknown",h=p[o]||"Unspecified",j=g||"None",b=S(u),y=S(r),w=b!=="Unknown"?b:y;return e.jsxs("li",{className:"timeline-item",children:[e.jsxs("div",{className:"timeline-header",children:[e.jsx("strong",{children:N(r)})," ",e.jsxs("span",{className:"timeline-date",children:["(",w,")"]})]}),e.jsxs("div",{className:"timeline-region",children:[e.jsx("span",{className:"timeline-label",children:"Region:"})," ",e.jsx("em",{children:u!=="Unknown"?N(u):"Unspecified"})]}),e.jsxs("div",{className:"timeline-meta",children:[e.jsx("span",{className:"timeline-label",children:"Published by:"})," ",e.jsx("em",{children:h!=="Unknown"?h:"Unspecified"})]}),e.jsxs("div",{className:"timeline-remarks",children:[e.jsx("span",{className:"timeline-label",children:"Sighting remarks:"})," ",e.jsx("em",{children:j!=="Unknown"?k(j):"None"})]})]},o)})})]}),e.jsxs("div",{className:"shark-images-container",children:[e.jsx("h3",{children:"Media Gallery"}),i.length>0?i.map((r,o)=>e.jsxs("div",{className:"shark-image-card",children:[e.jsx("img",{src:r.url,alt:`Shark image ${o}`,onClick:()=>c(o),style:{cursor:"pointer"}}),e.jsx("p",{className:"shark-image-meta",children:e.jsxs("small",{children:["ðŸ“¸ Creator: ",r.creator," | ",r.license]})})]},o)):e.jsx("p",{children:"No media available."})]})]}),t!==null&&e.jsx("div",{className:"image-overlay",onClick:m,children:e.jsxs("div",{className:"overlay-content",onClick:r=>r.stopPropagation(),children:[e.jsx("button",{className:"carousel-button left",onClick:()=>n(r=>Math.max(r-1,0)),disabled:t===0,children:"< "}),e.jsxs("div",{className:"overlay-image-wrapper",children:[e.jsx("img",{src:i[t].url,alt:`Expanded shark image ${t}`}),e.jsxs("p",{className:"overlay-meta",children:["ðŸ“¸ Creator: ",i[t].creator," | ",i[t].license]})]}),e.jsx("button",{className:"carousel-button right",onClick:()=>n(r=>Math.min(r+1,i.length-1)),disabled:t===i.length-1,children:"> "}),e.jsx("button",{className:"close-button",onClick:m,children:"X"})]})})]})};function U({criteria:s,onChange:l}){return e.jsxs("fieldset",{className:"filter-group",children:[e.jsx("legend",{children:"Media"}),e.jsxs("label",{className:"filter-label",children:[e.jsx("input",{type:"checkbox",checked:s.showOnlyWithMedia,onChange:()=>l({...s,showOnlyWithMedia:!s.showOnlyWithMedia})}),"Sharks with real-world images"]})]})}function O({criteria:s,onChange:l,countries:a,publishingCountries:t}){return e.jsxs("fieldset",{className:"filter-group",children:[e.jsx("legend",{children:"Location"}),e.jsxs("label",{className:"filter-label",children:["Country:",e.jsxs("select",{value:s.country,onChange:n=>l({...s,country:n.target.value}),className:"filter-select",children:[e.jsx("option",{value:"",children:"All"}),a.map(n=>e.jsx("option",{value:n,children:n},n))]})]}),e.jsxs("label",{className:"filter-label",children:["Publishing Country:",e.jsxs("select",{value:s.publishingCountry,onChange:n=>l({...s,publishingCountry:n.target.value}),className:"filter-select",children:[e.jsx("option",{value:"",children:"All"}),t.map(n=>e.jsx("option",{value:n,children:n},n))]})]})]})}function A({criteria:s,onChange:l,minYear:a,maxYear:t}){return e.jsxs("fieldset",{className:"filter-group",children:[e.jsx("legend",{children:"Time"}),e.jsxs("label",{className:"filter-label",children:["Year Range:",e.jsxs("div",{className:"range-inputs",children:[e.jsx("input",{type:"number",value:s.yearRange[0],onChange:n=>{const i=n.target.value;l({...s,yearRange:[i,s.yearRange[1]]})},onBlur:()=>{const n=parseInt(s.yearRange[0]),i=isNaN(n)?a:Math.max(a,Math.min(n,parseInt(s.yearRange[1])));l({...s,yearRange:[String(i),s.yearRange[1]]})},className:"filter-input"}),e.jsx("span",{style:{margin:"0 0.25rem"},children:"to"}),e.jsx("input",{type:"number",value:s.yearRange[1],onChange:n=>{const i=n.target.value;l({...s,yearRange:[s.yearRange[0],i]})},onBlur:()=>{const n=parseInt(s.yearRange[1]),i=isNaN(n)?t:Math.min(t,Math.max(n,parseInt(s.yearRange[0])));l({...s,yearRange:[s.yearRange[0],String(i)]})},className:"filter-input"})]})]})]})}function T({criteria:s,onChange:l,minRecords:a,maxRecords:t}){return e.jsxs("fieldset",{className:"filter-group",children:[e.jsx("legend",{children:"Metadata"}),e.jsxs("label",{className:"filter-label",children:[e.jsx("input",{type:"checkbox",checked:s.hasOccurrenceNotes,onChange:()=>l({...s,hasOccurrenceNotes:!s.hasOccurrenceNotes})}),"Sharks with occurrence notes"]}),e.jsxs("label",{className:"filter-label",children:["Min Records:",e.jsx("input",{type:"number",min:a,max:t,value:s.minRecords,onChange:n=>{const i=n.target.value;l({...s,minRecords:i})},onBlur:()=>{const n=parseInt(s.minRecords,10);if(isNaN(n)){l({...s,minRecords:a});return}const i=Math.max(a,Math.min(n,t));l({...s,minRecords:i})},className:"filter-input"})]})]})}function E({criteria:s,onChange:l}){return e.jsxs("fieldset",{className:"filter-group",children:[e.jsx("legend",{children:"Biological"}),e.jsxs("label",{className:"filter-label",children:["Sex:",e.jsxs("select",{value:s.sex,onChange:a=>l({...s,sex:a.target.value}),className:"filter-select",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"}),e.jsx("option",{value:"Unknown",children:"Unknown"})]})]}),e.jsxs("label",{className:"filter-label",children:["Life Stage:",e.jsxs("select",{value:s.lifeStage,onChange:a=>l({...s,lifeStage:a.target.value}),className:"filter-select",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"Juvenile",children:"Juvenile"}),e.jsx("option",{value:"Subadult",children:"Subadult"}),e.jsx("option",{value:"Adult",children:"Adult"}),e.jsx("option",{value:"Unknown",children:"Unknown"})]})]}),e.jsxs("label",{className:"filter-label",children:["Observation Type:",e.jsxs("select",{value:s.observationType,onChange:a=>l({...s,observationType:a.target.value}),className:"filter-select",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"Satellite",children:"Satellite Tracking"}),e.jsx("option",{value:"Human",children:"Human Sightings"})]})]})]})}function D({criteria:s,onChange:l,options:a}){const{countries:t=[],publishingCountries:n=[],minYear:i=2e3,maxYear:c=2024,minRecords:m=1,maxRecords:x=100}=a;return e.jsxs("div",{className:"shark-filters scrollable-filters",children:[e.jsx(U,{criteria:s,onChange:l}),e.jsx(O,{criteria:s,onChange:l,countries:t,publishingCountries:n}),e.jsx(A,{criteria:s,onChange:l,minYear:i,maxYear:c}),e.jsx(T,{criteria:s,onChange:l,minRecords:m,maxRecords:x}),e.jsx(E,{criteria:s,onChange:l})]})}function R(s,l){return Array.from(new Set(s.flatMap(a=>{var t;return((t=a[l])==null?void 0:t.split(",").map(n=>N(n).trim()).filter(Boolean))||[]}))).sort((a,t)=>a.localeCompare(t))}function B(s,l){return s.filter(a=>{var t;if(l.showOnlyWithMedia&&!(a.image&&a.image.trim()!==""&&a.image!=="Unknown")||l.country&&!(a.countries||"").split(",").map(c=>N(c).toLowerCase().trim()).some(c=>c.includes(l.country.toLowerCase()))||l.publishingCountry&&!(a.publishing||"").split(",").map(c=>N(c).toLowerCase().trim()).some(c=>c.includes(l.publishingCountry.toLowerCase())))return!1;if(l.yearRange){const n=parseInt(a.oldest),i=parseInt(a.newest),c=parseInt(l.yearRange[0]),m=parseInt(l.yearRange[1]);if(isNaN(n)||isNaN(i)||i<c||n>m)return!1}if(l.hasOccurrenceNotes&&k(a.remarks)==="None"||l.minRecords>0&&a.occurrences<l.minRecords||l.sex&&(((t=a.sex)==null?void 0:t.toLowerCase())||"")!==l.sex.toLowerCase()||l.lifeStage&&F(a).toLowerCase()!==l.lifeStage.toLowerCase())return!1;if(l.observationType){let n=!0;if(l.observationType=="Satellite"?n=a.machine>0:l.observationType=="Human"&&(n=a.human>0),!n)return!1}return!0})}function H({sharks:s,onReset:l,onSelect:a,selectedSharkId:t,DisplayComponent:n}){const i=R(s,"countries"),c=R(s,"publishing"),m=Math.min(...s.map(d=>d.occurrences||1)),x=Math.max(...s.map(d=>d.occurrences||1)),v=s.flatMap(d=>[parseInt(d.oldest),parseInt(d.newest)]).filter(d=>!isNaN(d)),p=Math.min(...v),g=Math.max(...v),r=M.useMemo(()=>({showOnlyWithMedia:!1,country:"",yearRange:[String(p),String(g)],hasOccurrenceNotes:!1,minRecords:1,sex:"",lifeStage:"",publishingCountry:"",observationType:""}),[p,g]),[o,u]=f.useState(r),[h,j]=f.useState(!0),b=()=>{u(r),j(!1),l&&l()},y=M.useMemo(()=>{console.log("Computing filteredSharks with criteria:",o);const d=B(s,o);return console.log(`filterSharks result: ${d.length}/${s.length} sharks`),d},[s,o]),w={countries:i,publishingCountries:c,minYear:p,maxYear:g,minRecords:m,maxRecords:x};return e.jsx("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:e.jsxs("div",{className:"shark-selector-list",children:[e.jsx("button",{onClick:b,className:`show-all-button ${t==null?"active":""}`,children:"Show All Sharks"}),e.jsxs("div",{className:"filter-toggle-container",children:[e.jsx("button",{onClick:()=>j(d=>!d),className:`toggle-filter-button ${h?"active":""}`,children:h?"Hide Filters â–²":"Show Filters â–¼"}),h&&e.jsx(D,{criteria:o,onChange:u,options:w})]}),e.jsx(n,{sharks:y,onSelect:a,selectedSharkId:t})]})})}export{$ as S,H as a};
