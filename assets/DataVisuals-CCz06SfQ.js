import{r as c,j as e,n as A,M as C}from"./index-_eeLRr-Q.js";import{c as p,H as I,s as B,b as Y,a as k,Y as E,d as G,e as H,D as x,S as $,R as U,f as D,g as F,p as w}from"./SexLifeStageData-CZu7i0h1.js";import{C as g}from"./ChartPlaceholder-BKzLtkh8.js";import{a as V,m as M,s as O}from"./linear-BcwBMSNj.js";const j=({label:t,field:r,data:a,selectedValue:s,onChange:l,inline:i})=>{const n=c.useMemo(()=>Array.from(new Set(a.map(m=>m[r]))).sort((m,h)=>typeof m=="number"&&typeof h=="number"?h-m:String(m).localeCompare(String(h))),[a,r]),o=`-- Choose a ${t.toUpperCase()} --`;return e.jsxs("div",{className:i?"data-metric-filter-inline":"data-metric-filter",children:[!i&&e.jsxs("label",{htmlFor:`${r}-select`,className:"data-metric-filter-label",children:["Select a ",t.toUpperCase(),":"]}),e.jsxs("select",{id:`${r}-select`,value:s,onChange:d=>l(d.target.value),className:"data-metric-filter-select",children:[e.jsx("option",{value:"",children:o}),n.map(d=>e.jsx("option",{value:d,children:d},d))]})]})},f=({children:t})=>e.jsx("div",{className:"data-grid",children:t}),q=t=>{const r=[];return t.forEach(a=>{const s=a.year;C.forEach(l=>{r.push({year:s,month:l,value:+a[l]||0})})}),r},L=t=>{const r=new Set,a=new Set(t.map(s=>Math.floor(s/10)*10));return s=>{const l=Math.floor(+s/10)*10;return a.has(l)&&!r.has(l)?(r.add(l),`${l}`):""}},R=()=>{const[t,r]=c.useState(""),a=c.useMemo(()=>A(p),[]),s=c.useMemo(()=>Object.keys(a).sort((n,o)=>Number(o)-Number(n)),[a]),l=c.useMemo(()=>q(p),[]),i=c.useMemo(()=>{const n={};return s.forEach(o=>{const d=Number(o),h=`${Math.floor(d/10)*10}s`;n[h]||(n[h]=[]),n[h].push(o)}),n},[s]);return e.jsxs(e.Fragment,{children:[e.jsxs("label",{htmlFor:"heatmap-decade-select",style:{display:"block"},children:["Select a ",e.jsx("span",{style:{fontWeight:"bold"},children:"decade"}),":"]}),e.jsxs("select",{id:"heatmap-decade-select",value:t,onChange:n=>r(n.target.value),children:[e.jsx("option",{value:"",children:"-- Choose a decade --"}),e.jsx("option",{value:"All",children:"All Years"}),Object.keys(i).sort((n,o)=>o.localeCompare(n)).map(n=>e.jsx("option",{value:n,children:n},n))]}),t&&(t==="All"||i[t])?e.jsx(I,{data:t==="All"?l:l.filter(n=>i[t].includes(String(n.year))),title:t==="All"?"Monthly Records Heatmap (All Years)":`Monthly Records Heatmap — ${t}`,yTickFormatter:t==="All"?L(l.map(n=>+n.year)):void 0}):t?e.jsx("p",{style:{textAlign:"center"},children:"No data available for this decade."}):e.jsx(g,{type:"heatmap",message:"Select a decade to see heatmap"})]})},T=({data:t,title:r="Bar Chart"})=>{const a=c.useRef(null),[s,l]=c.useState({width:0,height:0});return c.useEffect(()=>{const i=()=>{if(a.current){const{width:n,height:o}=a.current.getBoundingClientRect();l({width:n,height:o})}};return window.addEventListener("resize",i),i(),()=>window.removeEventListener("resize",i)},[]),c.useEffect(()=>{if(!t||t.length===0||s.width===0||s.height===0)return;const{width:i,height:n}=s,o=B(a.current);o.selectAll("*").remove();const d={top:40,right:5,bottom:60,left:30},m=i-d.left-d.right,h=n-d.top-d.bottom,b=Y().domain(t.map(u=>u.label)).range([0,m]).padding(.2),v=V().domain([0,M(t,u=>u.value)||0]).nice().range([h,0]),P=k().domain([0,M(t,u=>u.value)||0]).interpolator(E),y=o.append("g").attr("transform",`translate(${d.left},${d.top})`);y.append("g").call(G(v)),y.append("g").attr("transform",`translate(0,${h})`).call(H(b)).selectAll("text").attr("transform","rotate(-40)").style("text-anchor","end"),y.selectAll(".bar").data(t).enter().append("rect").attr("class","bar").attr("x",u=>b(u.label)).attr("y",u=>v(u.value)).attr("width",b.bandwidth()).attr("height",u=>h-v(u.value)).attr("fill",u=>P(u.value)),o.append("text").attr("x",i/2).attr("y",25).attr("text-anchor","middle").attr("class","chart-title").text(r)},[t,r,s]),e.jsx("svg",{ref:a,style:{width:"100%",height:"100%"}})},z=()=>{const[t,r]=c.useState(""),a=c.useMemo(()=>A(p),[]),s=c.useMemo(()=>a[t]||[],[t,a]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{className:"section-title",children:"Calendar Data Metrics"}),e.jsx(j,{label:"Year",field:"year",data:p,selectedValue:t,onChange:r,inline:!0})]}),e.jsxs(f,{children:[e.jsx("div",{className:"card-data-wrapper",children:e.jsx(R,{})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(x,{dataset:"calendar",filterField:"year",selectedFilter:t,displayFields:[{label:"Total Occurrences",field:"Total Occurrences"},{label:"Unique Sharks (with ID)",field:"Unique Sharks (with ID)"},{label:"Top 3 Publishing Countries",field:"Top 3 Publishing Countries"}]})}),e.jsx("div",{className:"card-data-wrapper",children:s.length>0?e.jsx(T,{data:s,title:`Shark Records by Month — ${t}`}):t?e.jsx("p",{style:{textAlign:"center"},children:"No data available for this year."}):e.jsx(g,{type:"bar",message:"Select a year to see monthly records"})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx($,{selectedYear:t,dataset:p})})]})]})},W=t=>t.toLowerCase().replace(/_/g," ").split(" ").map(s=>s==="and"?s:s.charAt(0).toUpperCase()+s.slice(1)).join(" "),_=(t,r)=>{const a=[];return t.forEach(s=>{C.forEach(l=>{const i=s[l];i!=null&&!Number.isNaN(+i)&&a.push({region:W(String(s[r])),month:l,"Total Occurrences":+i,"Avg Per Year (all)":+s["Avg Per Year (all)"],"Human Observation":+s.HUMAN_OBSERVATION||0,"Machine Observation":+s.MACHINE_OBSERVATION||0})})}),a},J=(t,r)=>{const a=r.filter(n=>n.region===t);if(!a.length)return[];const s=O(a,n=>Number(n["Human Observation"])),l=O(a,n=>Number(n["Machine Observation"])),i=s+l;return[{label:"Human Observation",value:s/i*100},{label:"Machine Observation",value:l/i*100}]},K=(t,r)=>r.filter(a=>a.region===t).reduce((a,s)=>(C.forEach(l=>{a[l]=(Number(a[l])||0)+(Number(s[l])||0)}),a),{}),N=({regionData:t,metric:r,selectedRegion:a})=>{const s=c.useMemo(()=>_(t,r),[t,r]),l=c.useMemo(()=>s.filter(n=>n.region===a),[s,a]),i=c.useMemo(()=>J(a,s),[a,s]);return c.useMemo(()=>a?K(a,s):{},[a,s]),e.jsx("div",{className:"region-occurrence-card",style:{width:"100%",height:"100%"},children:l.length>0?e.jsx(e.Fragment,{children:e.jsx(U,{data:l,segmentField:"month",ringField:"Avg Per Year (all)",valueField:"Total Occurrences",title:`Total Monthly Records — ${a}`,pieData:i})}):a?e.jsxs("p",{style:{textAlign:"center"},children:["No data available for this ",r,"."]}):e.jsx(g,{type:"radialHeatmap",message:`Select a ${r} to see monthly records`})})},Q=["Avg Per Year (all)","Avg Per Year (after 2020)","Avg Per Year (2010 - 2020)","Avg Per Year (2000 - 2010)","Avg Per Year (before 2000)"],S=({regionData:t,metric:r,selectedRegion:a})=>{const s=c.useMemo(()=>{if(!a)return[];const l=t.find(i=>i[r]===a);return l?Q.map(i=>{const n=i.match(/\((.*?)\)/);let o=n?n[1]:i;return o.toLowerCase()==="all"&&(o="all time"),{label:o,value:Number(l[i])||0}}):[]},[a]);return e.jsx("div",{className:"region-occurrence-card",style:{width:"100%",height:"100%"},children:a&&s.length>0?e.jsx(T,{data:s,title:`Mean Occurrences by Decade — ${a}`}):a?e.jsxs("p",{style:{textAlign:"center"},children:["No data available for this $",r,"."]}):e.jsx(g,{type:"bar",message:`Select a ${r} to see records by decade`})})},X=()=>{const[t,r]=c.useState(""),a={regionData:D,metric:"continent",selectedRegion:t};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{className:"section-title",children:"Continent Data Metrics"}),e.jsx(j,{label:"Continent",field:"continent",data:D,selectedValue:t,onChange:r,inline:!0})]}),e.jsxs(f,{children:[e.jsx("div",{className:"card-data-wrapper",children:e.jsx(x,{dataset:"continent",filterField:"continent",selectedFilter:t,displayFields:[{label:"Total Occurrences",field:"Total Occurrences"},{label:"Unique Sharks (with ID)",field:"Unique Sharks (with ID)"},{label:"Top 3 Publishing Countries",field:"Top 3 Publishing Countries"}]})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(N,{...a})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(S,{...a})})]})]})},Z=()=>{const[t,r]=c.useState(""),a={regionData:F,metric:"country",selectedRegion:t};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{className:"section-title",children:"Country Data Metrics"}),e.jsx(j,{label:"Country",field:"country",data:F,selectedValue:t,onChange:r,inline:!0})]}),e.jsxs(f,{children:[e.jsx("div",{className:"card-data-wrapper",children:e.jsx(x,{dataset:"country",filterField:"country",selectedFilter:t,displayFields:[{label:"Total Occurrences",field:"Total Occurrences"},{label:"Unique Sharks (with ID)",field:"Unique Sharks (with ID)"},{label:"Top 3 Publishing Countries",field:"Top 3 Publishing Countries"}]})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(N,{...a})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(S,{...a})})]})]})},ee=()=>{const[t,r]=c.useState(""),a={regionData:w,metric:"publishingCountry",selectedRegion:t};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{className:"section-title",children:"Publishing Country Data Metrics"}),e.jsx(j,{label:"Publishing Country",field:"publishingCountry",data:w,selectedValue:t,onChange:r,inline:!0})]}),e.jsxs(f,{children:[e.jsx("div",{className:"card-data-wrapper",children:e.jsx(x,{dataset:"publishingCountry",filterField:"publishingCountry",selectedFilter:t,displayFields:[{label:"Total Occurrences",field:"Total Occurrences"},{label:"Unique Sharks (with ID)",field:"Unique Sharks (with ID)"},{label:"Top 3 Countries Visited",field:"Top 3 Countries Visited"}]})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(N,{...a})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(S,{...a})})]})]})};function ne(){return e.jsx("div",{className:"page-content",children:e.jsxs("div",{className:"full-data-grid",children:[e.jsx("div",{className:"grid-section section-calendar",children:e.jsx(z,{})}),e.jsx("div",{className:"grid-section section-continent",children:e.jsx(X,{})}),e.jsx("div",{className:"grid-section section-country",children:e.jsx(Z,{})}),e.jsx("div",{className:"grid-section section-publishing",children:e.jsx(ee,{})})]})})}export{ne as default};
