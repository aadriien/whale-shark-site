import{r as o,j as e,M as v}from"./index-CwcZW0OQ.js";import{H as P,c as f,s as I,b as B,a as E,Y as $,d as k,e as G,D as b,S as H,R as U,f as F,g as O,p as M}from"./SexLifeStageData-DuAaqmJQ.js";import{C as y}from"./ChartPlaceholder-C1DRv8kc.js";import{a as Y,m as w,s as A}from"./linear-BcwBMSNj.js";const C=({label:t,field:s,data:a,selectedValue:r,onChange:n,inline:i})=>{const l=o.useMemo(()=>Array.from(new Set(a.map(h=>h[s]))).sort((h,p)=>typeof h=="number"&&typeof p=="number"?p-h:String(h).localeCompare(String(p))),[a,s]),c=`-- Choose a ${t.toUpperCase()} --`;return e.jsxs("div",{className:i?"data-metric-filter-inline":"data-metric-filter",children:[!i&&e.jsxs("label",{htmlFor:`${s}-select`,className:"data-metric-filter-label",children:["Select a ",t.toUpperCase(),":"]}),e.jsxs("select",{id:`${s}-select`,value:r,onChange:u=>n(u.target.value),className:"data-metric-filter-select",children:[e.jsx("option",{value:"",children:c}),l.map(u=>e.jsx("option",{value:u,children:u},u))]})]})},N=({children:t})=>e.jsx("div",{className:"data-grid",children:t}),V=t=>{const s={};return t.forEach(a=>{const r=a.year;s[r]=v.map(n=>({label:n,value:+a[n]||0}))}),s},q=t=>{const s=[];return t.forEach(a=>{const r=a.year;v.forEach(n=>{s.push({year:r,month:n,value:+a[n]||0})})}),s},L=t=>{const s=new Set,a=new Set(t.map(r=>Math.floor(r/10)*10));return r=>{const n=Math.floor(+r/10)*10;return a.has(n)&&!s.has(n)?(s.add(n),`${n}`):""}},z=()=>{const[t,s]=o.useState(""),a=o.useMemo(()=>V(f),[]),r=o.useMemo(()=>Object.keys(a).sort((l,c)=>c-l),[a]),n=o.useMemo(()=>q(f),[]),i=o.useMemo(()=>{const l={};return r.forEach(c=>{const h=`${Math.floor(c/10)*10}s`;l[h]||(l[h]=[]),l[h].push(c)}),l},[r]);return e.jsxs(e.Fragment,{children:[e.jsxs("label",{htmlFor:"heatmap-decade-select",style:{display:"block"},children:["Select a ",e.jsx("span",{style:{fontWeight:"bold"},children:"decade"}),":"]}),e.jsxs("select",{id:"heatmap-decade-select",value:t,onChange:l=>s(l.target.value),children:[e.jsx("option",{value:"",children:"-- Choose a decade --"}),e.jsx("option",{value:"All",children:"All Years"}),Object.keys(i).sort((l,c)=>c.localeCompare(l)).map(l=>e.jsx("option",{value:l,children:l},l))]}),t&&(t==="All"||i[t])?e.jsx(P,{data:t==="All"?n:n.filter(l=>i[t].includes(String(l.year))),title:t==="All"?"Monthly Records Heatmap (All Years)":`Monthly Records Heatmap — ${t}`,yTickFormatter:t==="All"?L(n.map(l=>+l.year)):void 0}):t?e.jsx("p",{style:{textAlign:"center"},children:"No data available for this decade."}):e.jsx(y,{type:"heatmap",message:"Select a decade to see heatmap"})]})},T=({data:t,title:s="Bar Chart"})=>{const a=o.useRef(null),[r,n]=o.useState({width:0,height:0});return o.useEffect(()=>{const i=()=>{if(a.current){const{width:l,height:c}=a.current.getBoundingClientRect();n({width:l,height:c})}};return window.addEventListener("resize",i),i(),()=>window.removeEventListener("resize",i)},[]),o.useEffect(()=>{if(!t||t.length===0||r.width===0||r.height===0)return;const{width:i,height:l}=r,c=I(a.current);c.selectAll("*").remove();const u={top:40,right:5,bottom:60,left:30},h=i-u.left-u.right,p=l-u.top-u.bottom,m=B().domain(t.map(d=>d.label)).range([0,h]).padding(.2),x=Y().domain([0,w(t,d=>d.value)||0]).nice().range([p,0]),g=E().domain([0,w(t,d=>d.value)||0]).interpolator($),j=c.append("g").attr("transform",`translate(${u.left},${u.top})`);j.append("g").call(k(x)),j.append("g").attr("transform",`translate(0,${p})`).call(G(m)).selectAll("text").attr("transform","rotate(-40)").style("text-anchor","end"),j.selectAll(".bar").data(t).enter().append("rect").attr("class","bar").attr("x",d=>m(d.label)).attr("y",d=>x(d.value)).attr("width",m.bandwidth()).attr("height",d=>p-x(d.value)).attr("fill",d=>g(d.value)),c.append("text").attr("x",i/2).attr("y",25).attr("text-anchor","middle").attr("class","chart-title").text(s)},[t,s,r]),e.jsx("svg",{ref:a,style:{width:"100%",height:"100%"}})},W=t=>{const s={};return t.forEach(a=>{const r=a.year;s[r]=v.map(n=>({label:n,value:+a[n]||0}))}),s},_=({selectedYear:t,onChange:s})=>{const a=o.useMemo(()=>W(f),[]),r=o.useMemo(()=>a[t]||[],[t,a]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{className:"section-title",children:"Calendar Data Metrics"}),e.jsx(C,{label:"Year",field:"year",data:f,selectedValue:t,onChange:s,inline:!0})]}),e.jsxs(N,{children:[e.jsx("div",{className:"card-data-wrapper",children:e.jsx(z,{})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(b,{dataset:"calendar",filterField:"year",selectedFilter:t,displayFields:[{label:"Total Occurrences",field:"Total Occurrences"},{label:"Unique Sharks (with ID)",field:"Unique Sharks (with ID)"},{label:"Top 3 Publishing Countries",field:"Top 3 Publishing Countries"}]})}),e.jsx("div",{className:"card-data-wrapper",children:r.length>0?e.jsx(T,{data:r,title:`Shark Records by Month — ${t}`}):t?e.jsx("p",{style:{textAlign:"center"},children:"No data available for this year."}):e.jsx(y,{type:"bar",message:"Select a year to see monthly records"})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(H,{selectedYear:t,dataset:f})})]})]})},R=t=>t.toLowerCase().replace(/_/g," ").split(" ").map(r=>r==="and"?r:r.charAt(0).toUpperCase()+r.slice(1)).join(" "),J=(t,s)=>{const a=[];return t.forEach(r=>{v.forEach(n=>{const i=r[n];i!=null&&!Number.isNaN(+i)&&a.push({region:R(r[s]),month:n,"Total Occurrences":+i,"Avg Per Year (all)":+r["Avg Per Year (all)"],"Human Observation":+r.HUMAN_OBSERVATION||0,"Machine Observation":+r.MACHINE_OBSERVATION||0})})}),a},S=({regionData:t,metric:s,selectedRegion:a,onRegionChange:r})=>{const n=o.useMemo(()=>J(t,s),[t,s]),i=o.useMemo(()=>n.filter(p=>p.region===a),[n,a]),l=p=>{const m=n.filter(d=>d.region===p);if(!m.length)return[];const x=A(m,d=>d["Human Observation"]),g=A(m,d=>d["Machine Observation"]),j=x+g;return[{label:"Human Observation",value:x/j*100},{label:"Machine Observation",value:g/j*100}]},c=o.useMemo(()=>l(a),[a,n]),u=p=>n.filter(m=>m.region===p).reduce((m,x)=>(v.forEach(g=>{m[g]=(m[g]||0)+(x[g]||0)}),m),{}),h=o.useMemo(()=>a?u(a):{},[a,n]);return e.jsx("div",{className:"region-occurrence-card",style:{width:"100%",height:"100%"},children:i.length>0?e.jsx(e.Fragment,{children:e.jsx(U,{data:i,segmentField:"month",ringField:"Avg Per Year (all)",valueField:"Total Occurrences",title:`Total Monthly Records — ${a}`,monthOccurrences:h,pieData:c})}):a?e.jsxs("p",{style:{textAlign:"center"},children:["No data available for this ",s,"."]}):e.jsx(y,{type:"radialHeatmap",message:`Select a ${s} to see monthly records`})})},K=["Avg Per Year (all)","Avg Per Year (after 2020)","Avg Per Year (2010 - 2020)","Avg Per Year (2000 - 2010)","Avg Per Year (before 2000)"],D=({regionData:t,metric:s,selectedRegion:a})=>{const r=o.useMemo(()=>{if(!a)return[];const n=t.find(i=>i[s]===a);return n?K.map(i=>{const l=i.match(/\((.*?)\)/);let c=l?l[1]:i;return c.toLowerCase()==="all"&&(c="all time"),{label:c,value:Number(n[i])||0}}):[]},[a]);return e.jsx("div",{className:"region-occurrence-card",style:{width:"100%",height:"100%"},children:a&&r.length>0?e.jsx(T,{data:r,title:`Mean Occurrences by Decade — ${a}`}):a?e.jsxs("p",{style:{textAlign:"center"},children:["No data available for this $",s,"."]}):e.jsx(y,{type:"bar",message:`Select a ${s} to see records by decade`})})},Q=({selectedRegion:t,onChange:s})=>{const a={regionData:F,metric:"continent",selectedRegion:t};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{className:"section-title",children:"Continent Data Metrics"}),e.jsx(C,{label:"Continent",field:"continent",data:F,selectedValue:t,onChange:s,inline:!0})]}),e.jsxs(N,{children:[e.jsx("div",{className:"card-data-wrapper",children:e.jsx(b,{dataset:"continent",filterField:"continent",selectedFilter:t,displayFields:[{label:"Total Occurrences",field:"Total Occurrences"},{label:"Unique Sharks (with ID)",field:"Unique Sharks (with ID)"},{label:"Top 3 Publishing Countries",field:"Top 3 Publishing Countries"}]})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(S,{...a})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(D,{...a})})]})]})},X=({selectedRegion:t,onChange:s})=>{const a={regionData:O,metric:"country",selectedRegion:t};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{className:"section-title",children:"Country Data Metrics"}),e.jsx(C,{label:"Country",field:"country",data:O,selectedValue:t,onChange:s,inline:!0})]}),e.jsxs(N,{children:[e.jsx("div",{className:"card-data-wrapper",children:e.jsx(b,{dataset:"country",filterField:"country",selectedFilter:t,displayFields:[{label:"Total Occurrences",field:"Total Occurrences"},{label:"Unique Sharks (with ID)",field:"Unique Sharks (with ID)"},{label:"Top 3 Publishing Countries",field:"Top 3 Publishing Countries"}]})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(S,{...a})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(D,{...a})})]})]})},Z=({selectedRegion:t,onChange:s})=>{const a={regionData:M,metric:"publishingCountry",selectedRegion:t};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{className:"section-title",children:"Publishing Country Data Metrics"}),e.jsx(C,{label:"Publishing Country",field:"publishingCountry",data:M,selectedValue:t,onChange:s,inline:!0})]}),e.jsxs(N,{children:[e.jsx("div",{className:"card-data-wrapper",children:e.jsx(b,{dataset:"publishingCountry",filterField:"publishingCountry",selectedFilter:t,displayFields:[{label:"Total Occurrences",field:"Total Occurrences"},{label:"Unique Sharks (with ID)",field:"Unique Sharks (with ID)"},{label:"Top 3 Countries Visited",field:"Top 3 Countries Visited"}]})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(S,{...a})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(D,{...a})})]})]})};function re(){const[t,s]=o.useState(""),[a,r]=o.useState(""),[n,i]=o.useState(""),[l,c]=o.useState("");return e.jsx("div",{className:"page-content",children:e.jsxs("div",{className:"full-data-grid",children:[e.jsx("div",{className:"grid-section section-calendar",children:e.jsx(_,{selectedYear:l,onChange:c})}),e.jsx("div",{className:"grid-section section-continent",children:e.jsx(Q,{selectedRegion:t,onChange:s})}),e.jsx("div",{className:"grid-section section-country",children:e.jsx(X,{selectedRegion:a,onChange:r})}),e.jsx("div",{className:"grid-section section-publishing",children:e.jsx(Z,{selectedRegion:n,onChange:i})})]})})}export{re as default};
