import{r as j,a as I,j as e,d as b,p as x,f as M,h as F,R as w}from"./index-XN5wJbaP.js";import{F as L}from"./FavoriteButton-BDiq8ueZ.js";const U=({shark:s})=>{const[n,a]=j.useState(null),i=s&&s.image!=="Unknown"?I(s.image):[],l=r=>a(r),t=()=>a(null);return j.useEffect(()=>{if(n===null)return;const r=o=>{o.key==="ArrowLeft"?a(d=>Math.max(d-1,0)):o.key==="ArrowRight"?a(d=>Math.min(d+1,i.length-1)):o.key==="Escape"&&t()};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[n,i.length]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"shark-images-container",children:[e.jsx("h3",{children:"Media Gallery"}),i.length>0?i.map((r,o)=>e.jsxs("div",{className:"shark-image-card",children:[e.jsx("img",{src:r.url,alt:`Shark image ${o}`,onClick:()=>l(o),style:{cursor:"pointer"}}),e.jsx("p",{className:"shark-image-meta",children:e.jsxs("small",{children:["ðŸ“¸ Creator: ",r.creator," | ",r.license]})})]},o)):e.jsx("p",{children:"No media available."})]}),n!==null&&e.jsx("div",{className:"image-overlay",onClick:t,children:e.jsxs("div",{className:"overlay-content",onClick:r=>r.stopPropagation(),children:[e.jsx("button",{className:"carousel-button left",onClick:()=>a(r=>Math.max(r-1,0)),disabled:n===0,children:"< "}),e.jsxs("div",{className:"overlay-image-wrapper",children:[e.jsx("img",{src:i[n].url,alt:`Expanded shark image ${n}`}),e.jsxs("p",{className:"overlay-meta",children:["ðŸ“¸ Creator: ",i[n].creator," | ",i[n].license]})]}),e.jsx("button",{className:"carousel-button right",onClick:()=>a(r=>Math.min(r+1,i.length-1)),disabled:n===i.length-1,children:"> "}),e.jsx("button",{className:"close-button",onClick:t,children:"X"})]})})]})},W=({shark:s})=>{if(!s)return e.jsxs("div",{className:"shark-info-panel",children:[e.jsx("h2",{children:"All Sharks Overview"}),e.jsx("p",{children:"Select a shark to view detailed tracking information."})]});const n=s.countries.split(",").map(t=>t.trim()),a=s.regions?s.regions.split(",").map(t=>t.trim()):[],i=s.publishing?s.publishing.split(",").map(t=>t.trim()):[],l=s.remarks||"";return e.jsxs("div",{className:"shark-info-panel",children:[e.jsxs("h2",{children:["ID: ",s.id,e.jsx(L,{sharkId:s.id})]}),e.jsxs("div",{className:"shark-panel-details",children:[e.jsxs("div",{className:"shark-traits",children:[e.jsxs("p",{className:"shark-details",children:[e.jsx("strong",{children:"Sex:"}),"Â  ",s.sex]}),e.jsxs("p",{className:"shark-details",children:[e.jsx("strong",{children:"Life Stage:"}),"Â  ",s.lifeStage]})]}),e.jsxs("div",{className:"shark-records",children:[e.jsxs("h3",{className:"shark-details",children:[e.jsx("strong",{children:"Total Records:"}),"Â  ",s.occurrences]}),e.jsxs("p",{className:"shark-details",children:[s.oldest," Â ...Â  ",s.newest]}),e.jsxs("p",{className:"shark-details",children:[e.jsx("strong",{children:"Satellite tracking:"}),"Â Â ",Math.round(s.machine/(s.machine+s.human)*100),"%"]}),e.jsxs("p",{className:"shark-details",children:[e.jsx("strong",{children:"Human sightings:"}),"Â Â ",Math.round(s.human/(s.machine+s.human)*100),"%"]})]}),e.jsxs("div",{className:"shark-regions",children:[e.jsx("h3",{className:"shark-details",children:"Places Visited"}),e.jsx("ul",{className:"timeline-list",children:n.map((t,r)=>{const o=a[r]||"Unknown",d=i[r]||"Unspecified",p=l||"None",u=b(o),m=b(t),h=u!=="Unknown"?u:m;return e.jsxs("li",{className:"timeline-item",children:[e.jsxs("div",{className:"timeline-header",children:[e.jsx("strong",{children:x(t)})," ",e.jsxs("span",{className:"timeline-date",children:["(",h,")"]})]}),e.jsxs("div",{className:"timeline-region",children:[e.jsx("span",{className:"timeline-label",children:"Region:"})," ",e.jsx("em",{children:o!=="Unknown"?x(o):"Unspecified"})]}),e.jsxs("div",{className:"timeline-meta",children:[e.jsx("span",{className:"timeline-label",children:"Published by:"})," ",e.jsx("em",{children:d!=="Unknown"?d:"Unspecified"})]}),e.jsxs("div",{className:"timeline-remarks",children:[e.jsx("span",{className:"timeline-label",children:"Sighting remarks:"})," ",e.jsx("em",{children:p!=="Unknown"?M(p):"None"})]})]},r)})})]}),e.jsx(U,{shark:s})]})]})};function O({criteria:s,onChange:n}){return e.jsxs("fieldset",{className:"filter-group",children:[e.jsx("legend",{children:"Media"}),e.jsxs("label",{className:"filter-label",children:[e.jsx("input",{type:"checkbox",checked:s.showOnlyWithMedia,onChange:()=>n({...s,showOnlyWithMedia:!s.showOnlyWithMedia})}),"Sharks with real-world images"]})]})}function A({criteria:s,onChange:n,countries:a,publishingCountries:i}){return e.jsxs("fieldset",{className:"filter-group",children:[e.jsx("legend",{children:"Location"}),e.jsxs("label",{className:"filter-label",children:["Country:",e.jsxs("select",{value:s.country,onChange:l=>n({...s,country:l.target.value}),className:"filter-select",children:[e.jsx("option",{value:"",children:"All"}),a.map(l=>e.jsx("option",{value:l,children:l},l))]})]}),e.jsxs("label",{className:"filter-label",children:["Publishing Country:",e.jsxs("select",{value:s.publishingCountry,onChange:l=>n({...s,publishingCountry:l.target.value}),className:"filter-select",children:[e.jsx("option",{value:"",children:"All"}),i.map(l=>e.jsx("option",{value:l,children:l},l))]})]})]})}function E({criteria:s,onChange:n,minYear:a,maxYear:i}){return e.jsxs("fieldset",{className:"filter-group",children:[e.jsx("legend",{children:"Time"}),e.jsxs("label",{className:"filter-label",children:["Year Range:",e.jsxs("div",{className:"range-inputs",children:[e.jsx("input",{type:"number",value:s.yearRange[0],onChange:l=>{const t=l.target.value;n({...s,yearRange:[t,s.yearRange[1]]})},onBlur:()=>{const l=parseInt(s.yearRange[0]),t=isNaN(l)?a:Math.max(a,Math.min(l,parseInt(s.yearRange[1])));n({...s,yearRange:[String(t),s.yearRange[1]]})},className:"filter-input"}),e.jsx("span",{style:{margin:"0 0.25rem"},children:"to"}),e.jsx("input",{type:"number",value:s.yearRange[1],onChange:l=>{const t=l.target.value;n({...s,yearRange:[s.yearRange[0],t]})},onBlur:()=>{const l=parseInt(s.yearRange[1]),t=isNaN(l)?i:Math.min(i,Math.max(l,parseInt(s.yearRange[0])));n({...s,yearRange:[s.yearRange[0],String(t)]})},className:"filter-input"})]})]})]})}function T({criteria:s,onChange:n,minRecords:a,maxRecords:i}){return e.jsxs("fieldset",{className:"filter-group",children:[e.jsx("legend",{children:"Metadata"}),e.jsxs("label",{className:"filter-label",children:[e.jsx("input",{type:"checkbox",checked:s.hasOccurrenceNotes,onChange:()=>n({...s,hasOccurrenceNotes:!s.hasOccurrenceNotes})}),"Sharks with occurrence notes"]}),e.jsxs("label",{className:"filter-label",children:["Min Records:",e.jsx("input",{type:"number",min:a,max:i,value:s.minRecords,onChange:l=>{const t=l.target.value;n({...s,minRecords:t})},onBlur:()=>{const l=parseInt(s.minRecords,10);if(isNaN(l)){n({...s,minRecords:a});return}const t=Math.max(a,Math.min(l,i));n({...s,minRecords:t})},className:"filter-input"})]})]})}function B({criteria:s,onChange:n}){return e.jsxs("fieldset",{className:"filter-group",children:[e.jsx("legend",{children:"Biological"}),e.jsxs("label",{className:"filter-label",children:["Sex:",e.jsxs("select",{value:s.sex,onChange:a=>n({...s,sex:a.target.value}),className:"filter-select",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"}),e.jsx("option",{value:"Unknown",children:"Unknown"})]})]}),e.jsxs("label",{className:"filter-label",children:["Life Stage:",e.jsxs("select",{value:s.lifeStage,onChange:a=>n({...s,lifeStage:a.target.value}),className:"filter-select",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"Juvenile",children:"Juvenile"}),e.jsx("option",{value:"Subadult",children:"Subadult"}),e.jsx("option",{value:"Adult",children:"Adult"}),e.jsx("option",{value:"Unknown",children:"Unknown"})]})]}),e.jsxs("label",{className:"filter-label",children:["Observation Type:",e.jsxs("select",{value:s.observationType,onChange:a=>n({...s,observationType:a.target.value}),className:"filter-select",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"Satellite",children:"Satellite Tracking"}),e.jsx("option",{value:"Human",children:"Human Sightings"})]})]})]})}function D({criteria:s,onChange:n,options:a}){const{countries:i=[],publishingCountries:l=[],minYear:t=2e3,maxYear:r=2024,minRecords:o=1,maxRecords:d=100}=a;return e.jsxs("div",{className:"shark-filters scrollable-filters",children:[e.jsx(O,{criteria:s,onChange:n}),e.jsx(A,{criteria:s,onChange:n,countries:i,publishingCountries:l}),e.jsx(E,{criteria:s,onChange:n,minYear:t,maxYear:r}),e.jsx(T,{criteria:s,onChange:n,minRecords:o,maxRecords:d}),e.jsx(B,{criteria:s,onChange:n})]})}function S(s,n){return Array.from(new Set(s.flatMap(a=>{var i;return((i=a[n])==null?void 0:i.split(",").map(l=>x(l).trim()).filter(Boolean))||[]}))).sort((a,i)=>a.localeCompare(i))}function $(s,n){return s.filter(a=>{var i;if(n.showOnlyWithMedia&&!(a.image&&a.image.trim()!==""&&a.image!=="Unknown")||n.country&&!(a.countries||"").split(",").map(r=>x(r).toLowerCase().trim()).some(r=>r.includes(n.country.toLowerCase()))||n.publishingCountry&&!(a.publishing||"").split(",").map(r=>x(r).toLowerCase().trim()).some(r=>r.includes(n.publishingCountry.toLowerCase())))return!1;if(n.yearRange){const l=parseInt(a.oldest),t=parseInt(a.newest),r=parseInt(n.yearRange[0]),o=parseInt(n.yearRange[1]);if(isNaN(l)||isNaN(t)||t<r||l>o)return!1}if(n.hasOccurrenceNotes&&M(a.remarks)==="None"||n.minRecords>0&&a.occurrences<n.minRecords||n.sex&&(((i=a.sex)==null?void 0:i.toLowerCase())||"")!==n.sex.toLowerCase()||n.lifeStage&&F(a).toLowerCase()!==n.lifeStage.toLowerCase())return!1;if(n.observationType){let l=!0;if(n.observationType=="Satellite"?l=a.machine>0:n.observationType=="Human"&&(l=a.human>0),!l)return!1}return!0})}function Y({sharks:s,onReset:n,onSelect:a,selectedSharkId:i,DisplayComponent:l,disabled:t=!1}){const r=S(s,"countries"),o=S(s,"publishing"),d=Math.min(...s.map(c=>c.occurrences||1)),p=Math.max(...s.map(c=>c.occurrences||1)),u=s.flatMap(c=>[parseInt(c.oldest),parseInt(c.newest)]).filter(c=>!isNaN(c)),m=Math.min(...u),h=Math.max(...u),N=w.useMemo(()=>({showOnlyWithMedia:!1,country:"",yearRange:[String(m),String(h)],hasOccurrenceNotes:!1,minRecords:1,sex:"",lifeStage:"",publishingCountry:"",observationType:""}),[m,h]),[g,v]=j.useState(N),[f,y]=j.useState(!0),R=()=>{v(N),y(!1),n&&n()},k=w.useMemo(()=>{console.log("Computing filteredSharks with criteria:",g);const c=$(s,g);return console.log(`filterSharks result: ${c.length}/${s.length} sharks`),c},[s,g]),C={countries:r,publishingCountries:o,minYear:m,maxYear:h,minRecords:d,maxRecords:p};return e.jsx("div",{style:{display:"flex",flexDirection:"column",height:"100%",opacity:t?.6:1,pointerEvents:t?"none":"auto"},children:e.jsxs("div",{className:"shark-selector-list",children:[e.jsx("button",{onClick:R,className:`show-all-button ${i==null?"active":""}`,disabled:t,children:"Show All Sharks"}),e.jsxs("div",{className:"filter-toggle-container",children:[e.jsx("button",{onClick:()=>y(c=>!c),className:`toggle-filter-button ${f?"active":""}`,disabled:t,children:f?"Hide Filters â–²":"Show Filters â–¼"}),f&&e.jsx(D,{criteria:g,onChange:v,options:C,disabled:t})]}),e.jsx(l,{sharks:k,onSelect:a,selectedSharkId:i,disabled:t})]})})}export{W as S,Y as a};
