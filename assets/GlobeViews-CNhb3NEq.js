import{r as p,j as e}from"./index-CJYLFH8x.js";import{p as y,g as k,a as N,b as w,e as C,c as E,d as I,f as b,h as v,G as A,m as D}from"./DataUtils-DvTbEZP8.js";import"./three.module-biTqBqrf.js";import"./linear-BcwBMSNj.js";import"./country-list-CMU6V2HV.js";const R=({shark:a})=>{const[i,h]=p.useState(null),t=a&&a.image!=="Unknown"?y(a.image):[],m=s=>h(s),x=()=>h(null);if(p.useEffect(()=>{if(i===null)return;const s=n=>{n.key==="ArrowLeft"?h(l=>Math.max(l-1,0)):n.key==="ArrowRight"?h(l=>Math.min(l+1,t.length-1)):n.key==="Escape"&&x()};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[i,t.length]),!a)return e.jsxs("div",{className:"shark-info-panel",children:[e.jsx("h2",{children:"All Sharks Overview"}),e.jsx("p",{children:"Select a shark to view detailed tracking information."})]});const g=a.countries.split(",").map(s=>s.trim()),j=a.regions?a.regions.split(",").map(s=>s.trim()):[],f=a.publishing?a.publishing.split(",").map(s=>s.trim()):[],c=a.remarks?a.remarks.split(",").map(s=>s.trim()):[];return e.jsxs("div",{className:"shark-info-panel",children:[e.jsxs("h2",{children:["ID: ",a.id]}),e.jsxs("div",{className:"shark-panel-details",children:[e.jsxs("div",{className:"shark-traits",children:[e.jsxs("p",{className:"shark-details",children:[e.jsx("strong",{children:"Sex:"}),"  ",a.sex]}),e.jsxs("p",{className:"shark-details",children:[e.jsx("strong",{children:"Life Stage:"}),"  ",a.lifeStage]})]}),e.jsxs("div",{className:"shark-records",children:[e.jsxs("h3",{className:"shark-details",children:[e.jsx("strong",{children:"Total Records:"}),"  ",a.occurrences]}),e.jsxs("p",{className:"shark-details",children:[a.oldest,"  ...  ",a.newest]}),e.jsxs("p",{className:"shark-details",children:[e.jsx("strong",{children:"Satellite tracking:"}),"  ",Math.round(a.machine/(a.machine+a.human)*100),"%"]}),e.jsxs("p",{className:"shark-details",children:[e.jsx("strong",{children:"Human sightings:"}),"  ",Math.round(a.human/(a.machine+a.human)*100),"%"]})]}),e.jsxs("div",{className:"shark-regions",children:[e.jsx("h3",{className:"shark-details",children:"Places Visited"}),e.jsx("ul",{className:"timeline-list",children:g.map((s,n)=>{const l=j[n]||"Unknown",r=f[n]||"Unspecified",o=c[n]||"None",d=k(l),u=k(s),S=d!=="Unknown"?d:u;return e.jsxs("li",{className:"timeline-item",children:[e.jsxs("div",{className:"timeline-header",children:[e.jsx("strong",{children:N(s)})," ",e.jsxs("span",{className:"timeline-date",children:["(",S,")"]})]}),e.jsxs("div",{className:"timeline-region",children:[e.jsx("span",{className:"timeline-label",children:"Region:"})," ",e.jsx("em",{children:l!=="Unknown"?N(l):"Unspecified"})]}),e.jsxs("div",{className:"timeline-meta",children:[e.jsx("span",{className:"timeline-label",children:"Published by:"})," ",e.jsx("em",{children:r!=="Unknown"?r:"Unspecified"})]}),e.jsxs("div",{className:"timeline-remarks",children:[e.jsx("span",{className:"timeline-label",children:"Sighting remarks:"})," ",e.jsx("em",{children:o!=="Unknown"?w(o):"None"})]})]},n)})})]}),e.jsxs("div",{className:"shark-images-container",children:[e.jsx("h3",{children:"Media Gallery"}),t.length>0?t.map((s,n)=>e.jsxs("div",{className:"shark-image-card",children:[e.jsx("img",{src:s.url,alt:`Shark image ${n}`,onClick:()=>m(n),style:{cursor:"pointer"}}),e.jsx("p",{className:"shark-image-meta",children:e.jsxs("small",{children:["📸 Creator: ",s.creator," | ",s.license]})})]},n)):e.jsx("p",{children:"No media available."})]})]}),i!==null&&e.jsx("div",{className:"image-overlay",onClick:x,children:e.jsxs("div",{className:"overlay-content",onClick:s=>s.stopPropagation(),children:[e.jsx("button",{className:"carousel-button left",onClick:()=>h(s=>Math.max(s-1,0)),disabled:i===0,children:"< "}),e.jsxs("div",{className:"overlay-image-wrapper",children:[e.jsx("img",{src:t[i].url,alt:`Expanded shark image ${i}`}),e.jsxs("p",{className:"overlay-meta",children:["📸 Creator: ",t[i].creator," | ",t[i].license]})]}),e.jsx("button",{className:"carousel-button right",onClick:()=>h(s=>Math.min(s+1,t.length-1)),disabled:i===t.length-1,children:"> "}),e.jsx("button",{className:"close-button",onClick:x,children:"X"})]})})]})},M=new Set(["Africa","Antarctica","Asia","Europe","North America","Oceania","South America"]);function U({sharks:a,onReset:i,onSelect:h,selectedSharkId:t}){const[m,x]=p.useState({}),g={},[j,f]=p.useState(!1);(j?a.filter(n=>n.image&&n.image!=="Unknown"&&n.image.trim()!==""):a).forEach(n=>{C(n.continent).forEach(r=>{M.has(r)&&(g[r]||(g[r]=[]),g[r].push(n))})});const s=n=>{x(l=>({...l,[n]:!l[n]}))};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[e.jsx("button",{onClick:i,className:t==null?"active":"",children:e.jsx("span",{className:"all-sharks-button-text",children:"Show All Sharks"})}),e.jsxs("div",{className:"shark-selector-list",children:[e.jsx("div",{className:"media-toggle-container",children:e.jsxs("label",{style:{margin:"0.5rem 0 1rem",fontSize:"0.9rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:j,onChange:()=>f(!j),style:{marginRight:"0.5rem"}}),"Show only sharks with ",e.jsx("strong",{children:"MEDIA"})]})}),e.jsx("div",{className:"scrollable-sharks-list",children:Object.entries(g).sort(([n],[l])=>n.localeCompare(l)).map(([n,l])=>{const r=m[n];return e.jsxs("div",{className:"continent-dropdown",children:[e.jsxs("div",{className:"continent-header",onClick:()=>s(n),children:[n," ",r?"▾":"▸"]}),r&&e.jsx("div",{className:"continent-shark-list",children:l.map(o=>e.jsx("div",{className:`shark-selector-item ${o.id===t?"selected":""}`,onClick:()=>h(o.id),children:(()=>{const d=N(o.countries.trim()),u=E(d);return e.jsxs(e.Fragment,{children:[u?e.jsxs("div",{className:"flag-and-code",children:[e.jsx("img",{src:`https://flagcdn.com/24x18/${u}.png`,alt:d,title:d,className:"flag-icon",loading:"lazy"}),e.jsx("span",{className:"country-code",children:u.toUpperCase()})]}):e.jsxs("span",{className:"flag-and-code",title:d,role:"img","aria-label":"unknown country",children:["🌍 ",e.jsx("span",{className:"country-code",children:"N/A"})]}),o.id]})})()},o.id))})]},n)})})]})]})}function T(){const[a,i]=p.useState(null),[h,t]=p.useState(!0),m=p.useRef(),x=I(),g=D;p.useEffect(()=>{var c;if(a)(c=m.current)==null||c.highlightShark(a.id),t(!1);else{if(m.current){const s=m.current.getGlobe();b(s),v(s,x)}t(!0)}},[a]),p.useEffect(()=>{if(m.current){const c=m.current.getGlobe();b(c),v(c,x)}},[]);const j=c=>{if(typeof c=="object"&&c.lat!==void 0&&c.lng!==void 0){if(!h){console.log("Ignoring click because not all sharks are visible.");return}const{lat:s,lng:n}=c;console.log("Clicked at lat/lng:",s,n);const l=3,r=x.find(o=>{const d=Math.abs(o.lat-s),u=Math.abs(o.lng-n);return d<l&&u<l});if(r){const o=r.id.split("-")[0];console.log("Matched shark:",r.id," with ID: ",o);const d=g.find(u=>u.id==o)||null;console.log("Sending shark obect:",d),i(d)}else console.log("No nearby shark found."),i(null)}else{const s=g.find(n=>n.id==c)||null;i(s)}},f=()=>{i(null),t(!0)};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",overflowY:"auto",textAlign:"center",paddingTop:"60px"},children:[e.jsx("h1",{children:"GlobeViews Page"}),e.jsxs("div",{className:"globe-views-container",children:[e.jsx("div",{className:"info-sidebar",children:e.jsx(R,{shark:a,onReset:f})}),e.jsx("div",{className:"globe-container",children:e.jsx(A,{ref:m,onSharkClick:j})}),e.jsx("div",{className:"shark-selector",children:e.jsx(U,{sharks:g,onSelect:j,onReset:f,selectedSharkId:a?a.id:null})})]})]})}export{T as default};
