import{r as o,j as e}from"./index-W2mpsWUc.js";import{H as I,C as v,c as f,s as B,b as $,a as E,Y as k,d as G,e as H,D as b,S as U,R as Y,f as D,g as F,p as M}from"./SexLifeStageData-RSvBtuCL.js";import{a as V,m as O,s as A}from"./linear-BcwBMSNj.js";const y=({label:t,field:s,data:a,selectedValue:r,onChange:n,inline:c})=>{const l=o.useMemo(()=>Array.from(new Set(a.map(h=>h[s]))).sort((h,p)=>typeof h=="number"&&typeof p=="number"?p-h:String(h).localeCompare(String(p))),[a,s]),i=`-- Choose a ${t.toUpperCase()} --`;return e.jsxs("div",{className:c?"data-metric-filter-inline":"data-metric-filter",children:[!c&&e.jsxs("label",{htmlFor:`${s}-select`,className:"data-metric-filter-label",children:["Select a ",t.toUpperCase(),":"]}),e.jsxs("select",{id:`${s}-select`,value:r,onChange:u=>n(u.target.value),className:"data-metric-filter-select",children:[e.jsx("option",{value:"",children:i}),l.map(u=>e.jsx("option",{value:u,children:u},u))]})]})},C=({children:t})=>e.jsx("div",{className:"data-grid",children:t}),w=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],q=t=>{const s={};return t.forEach(a=>{const r=a.year;s[r]=w.map(n=>({label:n,value:+a[n]||0}))}),s},J=t=>{const s=[];return t.forEach(a=>{const r=a.year;w.forEach(n=>{s.push({year:r,month:n,value:+a[n]||0})})}),s},z=t=>{const s=new Set,a=new Set(t.map(r=>Math.floor(r/10)*10));return r=>{const n=Math.floor(+r/10)*10;return a.has(n)&&!s.has(n)?(s.add(n),`${n}`):""}},L=()=>{const[t,s]=o.useState(""),a=o.useMemo(()=>q(f),[]),r=o.useMemo(()=>Object.keys(a).sort((l,i)=>i-l),[a]),n=o.useMemo(()=>J(f),[]),c=o.useMemo(()=>{const l={};return r.forEach(i=>{const h=`${Math.floor(i/10)*10}s`;l[h]||(l[h]=[]),l[h].push(i)}),l},[r]);return e.jsxs(e.Fragment,{children:[e.jsxs("label",{htmlFor:"heatmap-decade-select",style:{display:"block"},children:["Select a ",e.jsx("span",{style:{fontWeight:"bold"},children:"decade"}),":"]}),e.jsxs("select",{id:"heatmap-decade-select",value:t,onChange:l=>s(l.target.value),children:[e.jsx("option",{value:"",children:"-- Choose a decade --"}),e.jsx("option",{value:"All",children:"All Years"}),Object.keys(c).sort((l,i)=>i.localeCompare(l)).map(l=>e.jsx("option",{value:l,children:l},l))]}),t&&(t==="All"||c[t])?e.jsx(I,{data:t==="All"?n:n.filter(l=>c[t].includes(String(l.year))),title:t==="All"?"Monthly Records Heatmap (All Years)":`Monthly Records Heatmap — ${t}`,yTickFormatter:t==="All"?z(n.map(l=>+l.year)):void 0}):t?e.jsx("p",{style:{textAlign:"center"},children:"No data available for this decade."}):e.jsx(v,{type:"heatmap",message:"Select a decade to see heatmap"})]})},T=({data:t,title:s="Bar Chart"})=>{const a=o.useRef(null),[r,n]=o.useState({width:0,height:0});return o.useEffect(()=>{const c=()=>{if(a.current){const{width:l,height:i}=a.current.getBoundingClientRect();n({width:l,height:i})}};return window.addEventListener("resize",c),c(),()=>window.removeEventListener("resize",c)},[]),o.useEffect(()=>{if(!t||t.length===0||r.width===0||r.height===0)return;const{width:c,height:l}=r,i=B(a.current);i.selectAll("*").remove();const u={top:40,right:5,bottom:60,left:30},h=c-u.left-u.right,p=l-u.top-u.bottom,m=$().domain(t.map(d=>d.label)).range([0,h]).padding(.2),x=V().domain([0,O(t,d=>d.value)||0]).nice().range([p,0]),g=E().domain([0,O(t,d=>d.value)||0]).interpolator(k),j=i.append("g").attr("transform",`translate(${u.left},${u.top})`);j.append("g").call(G(x)),j.append("g").attr("transform",`translate(0,${p})`).call(H(m)).selectAll("text").attr("transform","rotate(-40)").style("text-anchor","end"),j.selectAll(".bar").data(t).enter().append("rect").attr("class","bar").attr("x",d=>m(d.label)).attr("y",d=>x(d.value)).attr("width",m.bandwidth()).attr("height",d=>p-x(d.value)).attr("fill",d=>g(d.value)),i.append("text").attr("x",c/2).attr("y",25).attr("text-anchor","middle").style("font-size","14px").attr("font-weight","bold").text(s)},[t,s,r]),e.jsx("svg",{ref:a,style:{width:"100%",height:"100%"}})},W=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],_=t=>{const s={};return t.forEach(a=>{const r=a.year;s[r]=W.map(n=>({label:n,value:+a[n]||0}))}),s},R=({selectedYear:t,onChange:s})=>{const a=o.useMemo(()=>_(f),[]),r=o.useMemo(()=>a[t]||[],[t,a]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{className:"section-title",children:"Calendar Data Metrics"}),e.jsx(y,{label:"Year",field:"year",data:f,selectedValue:t,onChange:s,inline:!0})]}),e.jsxs(C,{children:[e.jsx("div",{className:"card-data-wrapper",children:e.jsx(L,{})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(b,{dataset:"calendar",filterField:"year",selectedFilter:t,displayFields:[{label:"Total Occurrences",field:"Total Occurrences"},{label:"Unique Sharks (with ID)",field:"Unique Sharks (with ID)"},{label:"Top 3 Publishing Countries",field:"Top 3 Publishing Countries"}]})}),e.jsx("div",{className:"card-data-wrapper",children:r.length>0?e.jsx(T,{data:r,title:`Shark Records by Month — ${t}`}):t?e.jsx("p",{style:{textAlign:"center"},children:"No data available for this year."}):e.jsx(v,{type:"bar",message:"Select a year to see monthly records"})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(U,{selectedYear:t,dataset:f})})]})]})},P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],K=t=>t.toLowerCase().replace(/_/g," ").split(" ").map(r=>r==="and"?r:r.charAt(0).toUpperCase()+r.slice(1)).join(" "),Q=(t,s)=>{const a=[];return t.forEach(r=>{P.forEach(n=>{const c=r[n];c!=null&&!Number.isNaN(+c)&&a.push({region:K(r[s]),month:n,"Total Occurrences":+c,"Avg Per Year (all)":+r["Avg Per Year (all)"],"Human Observation":+r.HUMAN_OBSERVATION||0,"Machine Observation":+r.MACHINE_OBSERVATION||0})})}),a},N=({regionData:t,metric:s,selectedRegion:a,onRegionChange:r})=>{const n=o.useMemo(()=>Q(t,s),[t,s]),c=o.useMemo(()=>n.filter(p=>p.region===a),[n,a]),l=p=>{const m=n.filter(d=>d.region===p);if(!m.length)return[];const x=A(m,d=>d["Human Observation"]),g=A(m,d=>d["Machine Observation"]),j=x+g;return[{label:"Human Observation",value:x/j*100},{label:"Machine Observation",value:g/j*100}]},i=o.useMemo(()=>l(a),[a,n]),u=p=>n.filter(m=>m.region===p).reduce((m,x)=>(P.forEach(g=>{m[g]=(m[g]||0)+(x[g]||0)}),m),{}),h=o.useMemo(()=>a?u(a):{},[a,n]);return e.jsx("div",{className:"region-occurrence-card",style:{width:"100%",height:"100%"},children:c.length>0?e.jsx(e.Fragment,{children:e.jsx(Y,{data:c,segmentField:"month",ringField:"Avg Per Year (all)",valueField:"Total Occurrences",title:`Total Monthly Records — ${a}`,monthOccurrences:h,pieData:i})}):a?e.jsxs("p",{style:{textAlign:"center"},children:["No data available for this ",s,"."]}):e.jsx(v,{type:"radialHeatmap",message:`Select a ${s} to see monthly records`})})},X=["Avg Per Year (all)","Avg Per Year (after 2020)","Avg Per Year (2010 - 2020)","Avg Per Year (2000 - 2010)","Avg Per Year (before 2000)"],S=({regionData:t,metric:s,selectedRegion:a})=>{const r=o.useMemo(()=>{if(!a)return[];const n=t.find(c=>c[s]===a);return n?X.map(c=>{const l=c.match(/\((.*?)\)/);let i=l?l[1]:c;return i.toLowerCase()==="all"&&(i="all time"),{label:i,value:Number(n[c])||0}}):[]},[a]);return e.jsx("div",{className:"region-occurrence-card",style:{width:"100%",height:"100%"},children:a&&r.length>0?e.jsx(T,{data:r,title:`Mean Occurrences by Decade — ${a}`}):a?e.jsxs("p",{style:{textAlign:"center"},children:["No data available for this $",s,"."]}):e.jsx(v,{type:"bar",message:`Select a ${s} to see records by decade`})})},Z=({selectedRegion:t,onChange:s})=>{const a={regionData:D,metric:"continent",selectedRegion:t};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{className:"section-title",children:"Continent Data Metrics"}),e.jsx(y,{label:"Continent",field:"continent",data:D,selectedValue:t,onChange:s,inline:!0})]}),e.jsxs(C,{children:[e.jsx("div",{className:"card-data-wrapper",children:e.jsx(b,{dataset:"continent",filterField:"continent",selectedFilter:t,displayFields:[{label:"Total Occurrences",field:"Total Occurrences"},{label:"Unique Sharks (with ID)",field:"Unique Sharks (with ID)"},{label:"Top 3 Publishing Countries",field:"Top 3 Publishing Countries"}]})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(N,{...a})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(S,{...a})})]})]})},ee=({selectedRegion:t,onChange:s})=>{const a={regionData:F,metric:"country",selectedRegion:t};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{className:"section-title",children:"Country Data Metrics"}),e.jsx(y,{label:"Country",field:"country",data:F,selectedValue:t,onChange:s,inline:!0})]}),e.jsxs(C,{children:[e.jsx("div",{className:"card-data-wrapper",children:e.jsx(b,{dataset:"country",filterField:"country",selectedFilter:t,displayFields:[{label:"Total Occurrences",field:"Total Occurrences"},{label:"Unique Sharks (with ID)",field:"Unique Sharks (with ID)"},{label:"Top 3 Publishing Countries",field:"Top 3 Publishing Countries"}]})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(N,{...a})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(S,{...a})})]})]})},te=({selectedRegion:t,onChange:s})=>{const a={regionData:M,metric:"publishingCountry",selectedRegion:t};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{className:"section-title",children:"Publishing Country Data Metrics"}),e.jsx(y,{label:"Publishing Country",field:"publishingCountry",data:M,selectedValue:t,onChange:s,inline:!0})]}),e.jsxs(C,{children:[e.jsx("div",{className:"card-data-wrapper",children:e.jsx(b,{dataset:"publishingCountry",filterField:"publishingCountry",selectedFilter:t,displayFields:[{label:"Total Occurrences",field:"Total Occurrences"},{label:"Unique Sharks (with ID)",field:"Unique Sharks (with ID)"},{label:"Top 3 Countries Visited",field:"Top 3 Countries Visited"}]})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(N,{...a})}),e.jsx("div",{className:"card-data-wrapper",children:e.jsx(S,{...a})})]})]})};function ne(){const[t,s]=o.useState(""),[a,r]=o.useState(""),[n,c]=o.useState(""),[l,i]=o.useState("");return e.jsx("div",{className:"page-content",children:e.jsxs("div",{className:"full-data-grid",children:[e.jsx("div",{className:"grid-section section-calendar",children:e.jsx(R,{selectedYear:l,onChange:i})}),e.jsx("div",{className:"grid-section section-continent",children:e.jsx(Z,{selectedRegion:t,onChange:s})}),e.jsx("div",{className:"grid-section section-country",children:e.jsx(ee,{selectedRegion:a,onChange:r})}),e.jsx("div",{className:"grid-section section-publishing",children:e.jsx(te,{selectedRegion:n,onChange:c})})]})})}export{ne as default};
